# 聚簇索引和非聚簇索引

InnoDB 里的聚簇索引就是主键索引，聚簇索引以外的称为非聚簇索引（二级索引/辅助索引），默认情况下都以 B+ 树实现。

## 两种索引

> B 树和 B+ 树区别：
>
> B 树的数据存在所有节点，而 B+ 树的数据存在叶子节点。这样 B+ 树降低了树高度，减少了磁盘I/O的次数，查询效率更高。
> B+ 树叶子节点之间采用双向链表，B 树的叶子节点之间没有链表连接。这样 B+ 树对范围查询和排序的性能会更好。

聚簇索引将索引和行数据放在一块儿（这样适合大范围查询和排序操作，方便范围扫描和按序读取）。  
非叶子节点存储主键和页号

非聚簇索引则是将数据和索引分开存储（索引列和主键在一起），索引结构的叶子节点指向数据位置。

InnoDB 的表要求必须有聚簇索引（且仅有一个）：
    - 如果表定义了主键，则主键即为索引
    - 如果表没有定义主键，则取第一个非空unique列作为索引
    - 如果两者都没有，InnoDB 则会生成一个名为 GEN_CLUST_INDEX 的包含 row Id 的综合列，行 id 作为索引。

通过二级索引查找得到 id，然后去主键索引查询完整数据行的这个过程叫回表。

## 页

参考[MySQL 页完全指南——浅入深出页的原理](https://zhuanlan.zhihu.com/p/382375842)

页是 InnoDB 中最小管理单位，默认16KB。
